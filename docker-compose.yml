# Directorio de trabajo dentro del contenedor
working_dir: /app

# Monta el directorio actual (donde está el docker-compose.yml) 
# en /app dentro del contenedor.
# El segundo volumen excluye el directorio node_modules local 
# para usar el del contenedor y evitar conflictos de OS.
volumes:
  - .:/app
  - /app/node_modules

# Aquí se carga el archivo de secretos .env.secrets (que debe estar en .gitignore)
env_file:
  - .env.secrets
  # Nota: El archivo .env.secrets debe contener: GEMINI_API_KEY=XXXXXXX

# Mapeo de puertos: 
# - 8080 (Máquina Host) -> 5173 (Contenedor, puerto de Vite)
# Debes acceder a la app en http://localhost:8080
ports:
  - "8080:5173"

# Comando para ejecutar la aplicación:
# Instala dependencias y luego ejecuta 'npm run dev' con el host 0.0.0.0 
# para que sea accesible desde fuera del contenedor.
command: sh -c "npm install && npm run dev -- --host 0.0.0.0 --port 5173"

# Mantiene el contenedor activo para que el comando 'npm run dev' se ejecute correctamente.
tty: true
